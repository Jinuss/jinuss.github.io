<!DOCTYPE html>
<html>
<meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" name="viewport" />
<style>
    div[role="part"] {
        margin: 30px 10px 10px;
    }

    #part2,
    #part3,
    #part4,
    #part5,
    #part6,
    #part7 {
        display: none;
    }

    p {
        text-indent: 1em;
    }

    div.btns {
        display: flex;
        justify-content: space-around;
    }

    @keyframes blink {
        from {
            opacity: 0;
        }

        to {
            opacity: 1;
        }
    }

    .content::after {
        content: "|";
        animation: blink 1000ms infinite;
    }
</style>
<script src="./eventEmitter.js"></script>
<script src="./autoType.js"></script>
    <script src="./jq.js"></script>
<script src="./modal.js"></script>
<div id="part1" role="part">
    <p>左左，我们和好，好不好，让我重新以男朋友的身份来照顾你、陪伴你？</p>
    <div class="btns">
        <button id="a">好，可以</button>
        <button id="b">我要再考虑下</button>
    </div>
</div>

<div id="part2" role="part">
    <p id="content"></p>
</div>
<div id="part3" role="part">
    <p>
        两个月以来，我真的知道错了，经常梦见左左，梦中的自己也是懊悔不已，左左还是不肯原谅我吗？
    </p>
    <div class="btns">
        <button id="c">永远都不会原谅</button>
        <button id="d">我也很纠结</button>
    </div>
</div>

<div id="part4" role="part">
    <p>很难过，左左还是不愿意原谅我，错过可能会有遗憾，但有些坚持也没有意义</p>
    <div class="btns">
        <button id="e">返回上一步</button>
        <button id="f">再见,祝好</button>
    </div>
</div>

<div id="part5" role="part">
    <p>
        我知道我一直是个普通的人，但是我愿意尽我所能对左左好，愿意付出所有，真的希望左左能答应我，一起看去更大的世界，永远对生活满怀信心和期待。
    </p>
    <div class="btns">
        <button id="g">好，我答应</button>
        <button id="h">我还没想好</button>
    </div>
</div>

<div id="part6" role="part">
    <p id="content1"></p>
    <div class="btns">
        <button id="i" style="display: none">那,下个店见👋</button>
    </div>
</div>

<div id="part7" role="part">
    <p>
        傻左左，如果后面有一天喜欢不动了突然放弃了，请左左不要忘记我，我从来没有这么喜欢一个人，以后也不会了。谢谢左左，左左真的超级好，5555～😫
    </p>
    <div class="btns">
        <button id="j">要不，再来选一次😍</button>
    </div>
</div>

<script>
    //重写window.confirm
    var wConfirm = window.confirm;
    window.confirm = function (message) {
        try {
            var iframe = document.createElement("IFRAME");
            iframe.style.display = "none";
            iframe.setAttribute("src", "data:text/plain,");
            document.documentElement.appendChild(iframe);
            var alertFrame = window.frames[0];
            var iWindow = alertFrame.window;
            if (iWindow == undefined) {
                iWindow = alertFrame.contentWindow;
            }
            var result = iWindow.confirm(message);
            iframe.parentNode.removeChild(iframe);
            return result
        } catch (exc) {
            return wConfirm(message);
        }
    };

    function auto1() {
        var arr = [
            {
                type: "text",
                text: " 谢谢左左,还愿意给我机会，我会爱左左一生一世。第一次和左左说爱这个词，爱相对于喜欢意味着更多的责任。目前是攒够了彩礼钱（如果是以左左朋友为标准的话，我一定会让左左幸福的🌹",
            },
        ];

        var autoType = new AutoType("#content", arr, {
            speed: 200,
        });
        autoType.once("end", function () {
            console.log("事件结束");
        });
    }

    function auto2() {
        var arr = [
            {
                type: "text",
                text: "错过了这个村，就没这个店了哦",
            },
            {
                type: "wait",
                time: 2500,
            },
            {
                type: "delete",
                num: 6,
            },
            {
                type: "text",
                text: "我还是想在下个店等左左，哈哈哈哈😄",
            },
            { type: "br" },
            {
                type: "text",
                text: "想啥呢，左左一直是我坚定且唯一的思念，我才不会就这么放弃。",
            },
            {
                type: "wait",
                time: 3000,
            },
            { type: "br" },
            {
                type: "text",
                speed: 100,
                text: "emmmmm...,但如果哪天左左真的觉得我烦了，觉得和我在一起不会幸福也不会开心，就告诉我，我想那时候我应该不会再叨扰左左。",
            },
            {
                type: "text",
                text: "因为我想的，从来都是只想给左左带来快乐～",
            },
        ];

        var autoType = new AutoType("#content1", arr, {
            speed: 200,
        });
        autoType.once("end", function () {
            document.querySelector("#i").style.display = "block";
        });
    }

    window.onload = () => {
        const aBtn = document.querySelector("#a");
        const bBtn = document.querySelector("#b");
        aBtn.onclick = () => {
            togglePart("part2");
            auto1();
        };
        bBtn.onclick = () => {
            const result = confirm("啊，不是应该选👈左边这个【好,可以】吗？");
            var d = dialog({
                title: '🤔️',
                content: '啊，不是应该选👈左边这个【好,可以】吗？',
                okValue: '嗯，刚点错了',
                ok: function () {
                    togglePart("part2");
                    auto1();
                },
                cancelValue: '没点错',
                cancel: function () {
                    alert("可恶的臭左左,哼，臭左左😾");
                    setTimeout(() => {
                        togglePart("part3");
                    }, 1000);
                }
            });
            d.show();

        };

        const cBtn = document.querySelector("#c");
        const dBtn = document.querySelector("#d");
        cBtn.onclick = () => {
            const result = confirm(
                "啊，左左是可爱的左左，不是永远，真的不原谅我了吗？"
            );
            var d = dialog({
                title: '🤔️',
                content: '啊，左左是可爱的左左，不是永远，真的不原谅我了吗？',
                okValue: '好吧，原谅你了',
                ok: function () {
                    togglePart("part5");
                },
                cancelValue: '不原谅',
                cancel: function () {
                    var c = dialog({
                        title: '🤔️',
                        content: '真的真的不原谅我了吗？好难受啊☹️',
                        okValue: '还是原谅你了吧',
                        ok: function () {
                            togglePart("part5");
                        },
                        cancelValue: '不原谅',
                        cancel: function () {
                            togglePart("part4");
                        }
                    });
                    c.show();
                }
            });
            d.show();
        };
        dBtn.onclick = () => {
            alert("😧傻左左，纠结啥呢，有啥随时可以和我说呀？");
            togglePart("part5");
        };

        const eBtn = document.querySelector("#e");
        const fBtn = document.querySelector("#f");
        eBtn.onclick = () => {
            togglePart("part3");
        };
        fBtn.onclick = () => {
            togglePart("part6");
            auto2();
        };

        const gBtn = document.querySelector("#g");
        const hBtn = document.querySelector("#h");

        gBtn.onclick = () => {
            togglePart("part2");
        };
        hBtn.onclick = () => {
            alert("😂傻左左，不要紧呢，首先左左要开心🎉，其次的都是其次");
            setTimeout(() => {
                togglePart("part7");
            }, 1500);
        };

        const iBtn = document.querySelector("#i");
        iBtn.onclick = () => {
            alert("😂傻左左，不要紧呢，首先左左要开心🎉，其次的都是其次");
            setTimeout(() => {
                togglePart("part7");
            }, 1500);
        };

        const jBtn = document.querySelector("#j");
        jBtn.onclick = () => {
            togglePart("part1");
        };

        function togglePart(containerId) {
            const aDiv = document.querySelectorAll("div[role='part']");
            for (let i = 0; i < aDiv.length; i++) {
                aDiv[i].style.display = "none";
            }
            document.querySelector(`#${containerId}`).style.display = "block";
        }
    };
</script>

</html>
